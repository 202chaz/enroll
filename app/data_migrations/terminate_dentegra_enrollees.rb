require File.join(Rails.root, "lib/mongoid_migration_task")

class TerminateDentegraEnrollees < MongoidMigrationTask
  def migrate
    puts "*"*80 unless Rails.env.test?
    puts "terminate dentegra enrollees started" unless Rails.env.test?
    person_ids = ["53e68e79eb899ad9ca00009d", "53e68e7beb899ad9ca00018e", "53e68e88eb899ad9ca00094b", "53e68e89eb899ad9ca00098a", "53e68e8aeb899ad9ca000a7c", "53e68e8deb899ad9ca000be2", "53e68e9deb899ad9ca00152c", "53e68e9eeb899ad9ca0015e5", "53e68ea2eb899ad9ca001850", "53e68ea4eb899ad9ca00194d", "53e68ec4eb899ad9ca002c23", "53e68ec9eb899ad9ca002efa", "53e6924eeb899ad9ca01634a", "53e69253eb899ad9ca01652f", "53e6928deb899ad9ca017ab6", "53e69294eb899ad9ca017e56", "53e69299eb899ad9ca018117", "53e6929eeb899ad9ca01836f", "53e692a1eb899ad9ca0184e3", "53e692c1eb899ad9ca018a13", "53e692c2eb899ad9ca018ad1", "53e692d1eb899ad9ca019201", "53e692d2eb899ad9ca019246", "53e692d6eb899ad9ca0193e4", "53e692e6eb899ad9ca019b57", "53e692edeb899ad9ca019dcf", "53e692efeb899ad9ca019e8e", "53e692f3eb899ad9ca01a0a8", "53e69305eb899ad9ca01a796", "53e69315eb899ad9ca01af4c", "53e6932beb899ad9ca01b838", "53e6932feb899ad9ca01ba94", "53e6933feb899ad9ca01c2d8", "53e69342eb899ad9ca01c441", "53e69409eb899ad9ca01fe66", "53e69421eb899ad9ca0209b2", "53e6959deb899ad9ca027d17", "53e6959deb899ad9ca027d27", "53e695cceb899ad9ca028c4d", "53e695d3eb899ad9ca029061", "53e695d4eb899ad9ca02910f", "53e695dfeb899ad9ca0294ee", "53e695e0eb899ad9ca02956c", "53e6960aeb899ad9ca02a533", "53e6961beb899ad9ca02ab8b", "53e6963aeb899ad9ca02b6d3", "53e6963feb899ad9ca02b812", "53e69654eb899ad9ca02be03", "53e69659eb899ad9ca02c085", "53e69681eb899ad9ca02cfc7", "53e69684eb899ad9ca02d12e", "53e696a4eb899ad9ca02de78", "53e696baeb899ad9ca02e850", "53e696bdeb899ad9ca02e9b8", "53e696d4eb899ad9ca02f300", "53e696dceb899ad9ca02f5bc", "53e696ebeb899ad9ca02fcf9", "53e696f1eb899ad9ca030051", "53e6975feb899ad9ca032753", "53e697fdeb899ad9ca036048", "53e69813eb899ad9ca03697b", "53e69821eb899ad9ca036ed5", "53e69824eb899ad9ca036fd2", "53e69836eb899ad9ca037749", "53e69836eb899ad9ca0377a2", "53e69862eb899ad9ca0389a8", "53e69897eb899ad9ca039d6d", "53e698aceb899ad9ca03a3d1", "53e698b2eb899ad9ca03a5ed", "53e698d3eb899ad9ca03b267", "53e698e7eb899ad9ca03b985", "53e698e8eb899ad9ca03ba17", "53e698e8eb899ad9ca03ba17", "53e698eceb899ad9ca03bc16", "53e698ffeb899ad9ca03c3e9", "53e6990ceb899ad9ca03c8ea", "53e6992deb899ad9ca03d50b", "53e6993beb899ad9ca03d99c", "53e6993deb899ad9ca03daae", "53e69944eb899ad9ca03dc97", "53e69959eb899ad9ca03e3b4", "53e69962eb899ad9ca03e6fa", "53e6997aeb899ad9ca03efae", "53e69a26eb899ad9ca0415c4", "53e69a2feb899ad9ca0419c3", "53e69a3eeb899ad9ca041f7b", "53e69a60eb899ad9ca042c3d", "53e69a6eeb899ad9ca043045", "53e69a6feb899ad9ca043074", "53e69a77eb899ad9ca0433ed", "53e69a7ceb899ad9ca04354b", "53e69a9deb899ad9ca044201", "53e69a9eeb899ad9ca04424b", "53e69aa1eb899ad9ca0443b5", "53e69aa1eb899ad9ca0443c3", "53e69abeeb899ad9ca044b36", "53e69ac8eb899ad9ca044e8f", "53e69afdeb899ad9ca045e1e", "53e69b1ceb899ad9ca04686e", "53e69b25eb899ad9ca046afe", "53e69b25eb899ad9ca046b08", "53e69b2eeb899ad9ca046ec3", "53e69b38eb899ad9ca0472fe", "53e69b59eb899ad9ca047e43", "53e69b63eb899ad9ca048266", "53e69b6ceb899ad9ca04864a", "53e69b74eb899ad9ca048978", "53e69b75eb899ad9ca048a27", "53e69b83eb899ad9ca0490bb", "53e69b87eb899ad9ca049268", "53e69b8ceb899ad9ca04949f", "53e69b8deb899ad9ca049524", "53e69b8feb899ad9ca049642", "53e69b8feb899ad9ca049663", "53e69b91eb899ad9ca049746", "53e69bb6eb899ad9ca04a35d", "53e69bb6eb899ad9ca04a3ac", "53e69bbaeb899ad9ca04a4ea", "53e69bc6eb899ad9ca04a8a3", "53e69bcbeb899ad9ca04aaa2", "53e69bcceb899ad9ca04ab09", "53e69bcceb899ad9ca04ab12", "53e69bd0eb899ad9ca04ad0e", "53e69bdaeb899ad9ca04b1d4", "53e69bdaeb899ad9ca04b1d4", "53e69bdbeb899ad9ca04b216", "53e69bddeb899ad9ca04b337", "53e69be7eb899ad9ca04b78f", "53e69bedeb899ad9ca04ba7c", "53e69befeb899ad9ca04bbdb", "53e69befeb899ad9ca04bbed", "53e69bf1eb899ad9ca04bce9", "53e69bfceb899ad9ca04c16c", "53e69c10eb899ad9ca04c748", "53e69c12eb899ad9ca04c7af", "53e69c3aeb899ad9ca04d44d", "53e69cc2eb899ad9ca04fcfa", "53e69cfbeb899ad9ca051187", "53e69d2aeb899ad9ca051e27", "53e69d2beb899ad9ca051e63", "53e69d7feb899ad9ca053f97", "53e69da1eb899ad9ca054bdf", "53e69db1eb899ad9ca055105", "53e69e14eb899ad9ca057306", "53e69e21eb899ad9ca05785b", "53e6a03ceb899ad9ca0617e0", "53e6a0cceb899ad9ca06529b", "53e6a0cdeb899ad9ca065314", "53e6a0e2eb899ad9ca065a12", "53e6a0ffeb899ad9ca06640c", "53e6a100eb899ad9ca066470", "53e6a118eb899ad9ca066beb", "53e6a151eb899ad9ca067cbb", "53e6a169eb899ad9ca06839a", "53e6a18aeb899ad9ca068b6c", "53e6a273eb899ad9ca06ddfa", "53e6a2c5eb899ad9ca06ff1d", "53e6a2fceb899ad9ca071401", "53e6a30aeb899ad9ca07194d", "53e6a326eb899ad9ca072373", "53e6a34beb899ad9ca0730f9", "53e6a369eb899ad9ca073e0e", "53f21171d2b38b494f0002f1", "53f358d4d2b38b98d4000129", "53f358d4d2b38b98d4000133", "53f3b7a9eb899a201d00011f", "53f3b7aceb899a201d0001de", "53f3b7aceb899a201d0001de", "53f3b7bbeb899a201d00048b", "53fb6fb9eb899a277f000405", "53fb6fbaeb899a277f000415", "53fb6fbaeb899a277f000425", "53ff80f0eb899a9220000416", "540612cbeb899a9c4a00026e", "54073b76eb899a8870000028", "5416eb88d2b38b1b76000248", "5418455fd2b38bbbb3000303", "54184587d2b38bbbb30008c3", "54184591d2b38bbbb3000a22", "54184591d2b38bbbb3000a22", "541845a2d2b38bbbb3000c89", "54217b10d2b38b8b380002e5", "543d1e60d2b38b5169002111", "54468452d2b38bb6dc000012", "5446845dd2b38bb6dc0000c9", "545d662aeb899a20ac00107b", "545d6644eb899a20ac0012a2", "5475fa0b791e4b4df90002dc", "54807b94791e4b44790001c2", "54976eb3c403b6846700073b", "54976eb6c403b68467000741", "54976fc4c403b6846700092c", "549a19ddc403b6be3f0001fa", "54c6d268c403b6c1b5000244", "54c6d416c403b6c1b50003b6", "54c6d4efc403b63c2c00048d", "54e673bec403b627b40003ac", "54ebb95ec403b695fb00071a", "54ec88ca791e4be902001958", "54ecf81ac403b639b00007ac", "54ecf99dc403b639b0000824", "553aa183c403b6e2ed00004c", "55413c1fc403b63f910000c5", "55521fcdc403b615a20000a0", "556796c7c403b633e200013b", "55a81024c403b6474f000144", "55b13d7fc403b6dedc000092", "55b93801c403b6a5d8000187", "55d1fea8c403b682b80004d7", "55d1ff52c403b682b8000510", "55d637b0c403b6de6a000064", "55f320f0c403b6105b000486", "5654a2c869702d7233ce0000", "565c660a69702d1568ea0000", "566f10c9f1244e366b00008b", "56fd346650526c337d000001", "571b7360f1244e46340000be", "5817f748faca142eb6001946"]
    person_ids.each do |person_id|
      begin
        person = Person.find(person_id)
        family = person.primary_family
        if family.present?
          enrollments = family.enrollments
          if enrollments.present?
            enrollments.each do |enrollment|
              if enrollment.present? && enrollment.effective_on.year == 2016 && enrollment.plan.carrier_profile_id.to_s == "53e67210eb899a4603000013"
                results1 << person.id
                termination_date = "2016-12-31".to_date
                enrollment.set_coverage_termination_date(termination_date)
                enrollment.schedule_coverage_termination
              end
            end
          end
        end
      rescue Exception => e
        puts "#{e.message}"
      end
    end
    puts "terminate dentegra enrollees finished" unless Rails.env.test?
    puts "*"*80 unless Rails.env.test?
  end
end