<br>
<h4><strong>Activity</strong></h4>
<br>
<table class="table">
  <thead>
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Amount</th>
      <th>Balance</th>
    </tr>
  </thead>
  <tbody>
    <!-- Starting Balance -->
    <tr>
      <td></td>
      <td><strong>Previous Balance</strong></td>
      <td></td>
      <td><%= number_to_currency(@employer_profile.try(:employer_profile_account).try(:previous_balance)) || "Data not available" %></td>
    </tr>
    <!-- Payments -->
    <tr>
      <td class="payments-icon"><span class="pull-right glyphicon glyphicon-plus"></span></td>
      <td>Payments since last invoice</td>
      <!-- <td><%= (@employer_profile.try(:employer_profile_account).try(:payments)) || "Data not available" %></td> -->
      <td></td>
      <td></td>
    </tr>
    <% if @employer_profile.try(:employer_profile_account).try(:current_statement_activity) == nil %>
    <tr class="payments">
      <td></td>
      <td>There have been no payments since the last invoice.</td>
      <td></td>
      <td></td>
    </tr>
    <% else %>
      <% @employer_profile.try(:employer_profile_account).try(:current_statement_activity).each do |activity| %>
        <% if activity.type == "Payments" %>
          <tr class="payments">
            <td><%= activity.posting_date %></td>
            <td>Payment Type: <%= activity.payment_method %></td>
            <td><%= number_to_currency(activity.amount) %></td>
            <td></td>
          </tr>
        <% end %>
      <% end %>
    <% end %>

    <!-- New Charges -->
    <tr>
      <td></td>
      <td>New Charges</td>
      <td><%= (@employer_profile.try(:employer_profile_account).try(:new_charges)) || "Data not available" %></td>
      <td></td>
    </tr>
    <!-- Adjustments -->
    <tr>
      <td class="adjustments-icon"><span class="pull-right glyphicon glyphicon-plus"></span></td>
      <td>Adjustments since last invoice</td>
      <td></td>
      <td></td>
    </tr>

    <% if @employer_profile.try(:employer_profile_account).try(:current_statement_activity) == nil %>
    <tr class="adjustments">
      <td></td>
      <td>There have been no adjustments since the last invoice.</td>
      <td></td>
      <td></td>
    </tr>
    <% else %>
      <% @employer_profile.try(:employer_profile_account).try(:current_statement_activity).each do |activity| %>
        <% if activity.type == "Adjustments" %>
          <tr class="adjustments">
            <td><%= activity.coverage_month %></td>
            <td><%= activity.name %></td>
            <td><%= number_to_currency(activity.amount) %></td>
            <td></td>
          </tr>
        <% end %>
      <% end %>
    <% end %>

  </tbody>

</table>

<!-- display payment history -->
<%= render partial: "employers/employer_profiles/my_account/accounts/payment_history" %>

<script>
  $(document).ready(function() {
    $('.payments').hide();
    $('.adjustments').hide();
  });


  $('td.payments-icon').click(function() {
    $(this).find('span').toggleClass('glyphicon-plus').toggleClass('glyphicon-minus');
    $('tr.payments').toggle();
  });

  $('td.adjustments-icon').click(function() {
    $(this).find('span').toggleClass('glyphicon-plus').toggleClass('glyphicon-minus');
    $('tr.adjustments').toggle();
  });
</script>
