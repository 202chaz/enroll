<table id="<%= table_id %>" class="table table-striped table-bordered">
</table>

<script type="text/javascript" charset="utf-8" defer="defer">
  $(document).ready(function() {
  $('#<%= table_id %>').DataTable( {
      "processing": true,
      "serverSide": true,
      "ordering" : false,
      "ajax": {
        url: "<%= data_url %>",
	type: "POST",
	data: function ( d ) {
	  if ($('#<%= table_id %>').attr("data-filter") != null) {
         	  return $.extend( {}, d, { "filter": $('#<%= table_id %>').attr("data-filter") } );
	  } else {
	          return d;
	  }
	}
      },
	"language": {
	"lengthMenu": "Display _MENU_ records per page"
	},
	"columns" : [
	<% column_count = columns.length %>
	<% columns.each_with_index do |col, idx| %>
		{title: "<%= j col.title %>", data: "<%= j col.data_attribute %>", sortable: "<%= j col.sortable %>" }<%= (idx < (column_count - 1)) ? "," : ""  %>
<% end %>
]
      } );
  });
</script>
