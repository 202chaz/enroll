<% insured = (current_user.try(:has_consumer_role?) && current_user.identity_verified_date.nil? == false) || current_user.try(:has_employee_role?) %>
<% employer =  current_user.try(:has_employer_staff_role?) %>
<% broker =  current_user.try(:has_broker_agency_staff_role?) %>
<% roles = [insured, employer, broker] %>
<% portal_count = roles.select{|role|role}.count %>

<span>
  <% if portal_count == 1 %>
    <%= link_to "My Insured Portal", family_account_path(tab: 'home'), class: 'header-text' if insured %>
    <%= link_to "My Employer Portal", new_employers_employer_profile_path, class: 'header-text' if employer %>
    <%= link_to "My Broker Agency Portal", broker_agencies_root_path, class: 'header-text' if broker %>
    <span> | </span>
  <% elsif portal_count > 1 %>
    <div class="dropdown">
      <button aria-expanded="true" aria-haspopup="true" class="btn btn-default dropdown-toggle header-text" data-toggle="dropdown" id="dropdownMenu1" type="button">
        My Portals
        <span class="caret"></span>
      </button>
      <ul aria-labelledby="dropdownMenu1" class="dropdown-menu b brz">
        <% if insured %>
        <li><%= link_to "My Insured Portal", family_account_path(tab: 'home'), class: 'header-text' %></li>
        <% end %>
        <% if employer %>
        <li><%= link_to "My Employer Portal", new_employers_employer_profile_path, class: 'header-text' %></li>
        <% end %>
        <% if broker %>
        <li><%= link_to "My Broker Agency Portal", broker_agencies_root_path, class: 'header-text' %></li>
        <% end %>
      </ul>
    <span> | </span>
    </div>
  <% end %>
</span>
