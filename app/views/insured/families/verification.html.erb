<% content_for :navigation do %>
    <%= render 'navigation' %>
<% end %>

<h2>Family Verification Dashboard</h2>
<div class="col-xs-12 documents-tab">
  <% unless @person.has_consumer_role? %>
      <h4>No results found</h4>
  <% else %>
      <br/>
      <div class="row">
        <div class="col-md-7">
          <h4>Enrollment group verification status: <%= "pending" %></h4>
        </div>
        <div class="col-md-5">
          <h4>Verification due date: <%= "May 23, 2016" %></h4>
        </div>
      </div>
      <div class="module ivl-documents-table panel">
        <div class="table-responsive">
          <table class="table table-striped table-hover table-sm">
            <thead class="thead-default">
            <tr>
              <th>Family Member</th>
              <th>Person <br>Verification Status</th>
              <th>Verification Type</th>
              <th>Upload Documents</th>
              <th>Show</th>
            </tr>
            </thead>
            <tbody>
            <% @family_members.each do |member|%>
                <tr class="<%= cycle("odd", "even top") %>">
                  <td>
                    <%= member.person.first_name %> <%= member.person.last_name%>
                  </td>
                  <td>
                    <%= show_consumer_role_state(member.person.consumer_role) %>
                  </td>
                  <td>
                    <% member.person.verification_types.each do |verif_type| %>
                        <%= verif_type %>
                        <% ver = [1,2].sample %>
                        <% if ver == 1 %>
                          <span class="label label-danger pull-right">Outstanding</span>
                        <% else %>
                          <span class="label label-success pull-right">&nbsp;&nbsp;&nbsp; Verified &nbsp;&nbsp;&nbsp;&nbsp;</span>
                        <% end %>
                        <br/>
                    <% end %>
                  </td>
                  <td>
                    <% member.person.verification_types.each do |docs| %>
                        <%= render partial: "verification_upload", locals: {member: member} %>
                        <br/>
                    <% end %>
                  </td>
                  <td class="table-functions">
                    <a data-toggle="collapse" href="#<%= member.id %>" aria-expanded="false" aria-controls="<%= member.id %>">
                      <%= '<i class="fa fa-caret-down fa-2x" data-toggle="tooltip" title="View Documents"></i>'.html_safe if member.person.consumer_role.vlp_documents.present? %>
                    </a>
                  </td>
                </tr>
                <%= render partial: "verification_docs_table", locals: {member: member} %>
            <% end %>
            </tbody>
          </table>
        </div>
      </div>

  <% end %>
</div>