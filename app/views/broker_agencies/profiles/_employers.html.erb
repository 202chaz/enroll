<div class="container">
  <div class="row">
    <div id= 'message_form'></div>
    <div class="top-pd" id="inbox_provider_form">
      <span class="flash_message"></span>
      <%= form_tag(update_assign_broker_agencies_profile_path(id: @broker_agency_profile.id), method: :post, remote: true) do %>


      <div class="module">
        <table class="table table-striped" id="Broker-Employer-dataTable">
          <thead>
          <tr>
            <th><%= check_box_tag 'ER-Invoice-check-all' %></th>
            <th>FEIN</th>
            <th>Legal Name</th>
            <th>EE Count</th>
            <th>ER State</th>
            <th>Effective Date</th>
            <th>Broker</th>
            <th>General Agency</th>
          </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
      </div>




      <script type="text/javascript" charset="utf-8">
        // datatables setup
        $(document).ready(function() {
          $('#Broker-Employer-dataTable').DataTable( {
            "processing": true,
            "serverSide": true,
            "ordering" : false,
            "paging": true,
            "lengthMenu": [ 10, 25, 50, 100],
            "ajax": {
              url: "<%= employer_datatable_broker_agencies_profile_path(id: @broker_agency_profile.id, :format => :json) %>",
              type: "POST",
              data: function ( d ) {
                console.log("Broker-Employer-dataTable datatable")
              }
            },
            "columns": [
              { data: 'nothing'},
              { data: 'fein' },
              { data: 'legal_name' },
              { data: 'ee_count'},
              { data: 'er_state'},
              { data: 'effective_date'},
              { data: 'broker'},
              { data: 'general_agency'},
          ]
          } );
        });

        // Trigger datatable redraw on 90 day (30,60,90) filter buttons
        // $('#ERInvoiceFilter-Dropdown').change(function() {
        //     var table = $('#ER-invoices-dataTable').dataTable().api();
        //     table.draw();
        // });
        //
        // // Check/Uncheck All Checkboxes
        // $('#ER-Invoice-check-all').click(function() {
        //     var action = $(this).is(':checked') ? true : false;
        //     var group = $('input[name="employerId[]"]');
        //     group.each(function () {
        //       $(this).prop("checked", action);
        //     });
        // });


      </script>


        <div class="col-md-4">
          <h3>General Agencies</h3>
          <%= select_tag "general_agency_id", options_from_collection_for_select(@general_agency_profiles, :id, :legal_name), include_blank: 'Select General Agency' %>
          <%= hidden_field_tag :from_assign, false %>
          <%= submit_tag "Assign", class: 'btn btn-primary', id: 'assign_general_agency', disabled: true %>
          <%= submit_tag "Clear Assignment", class: 'btn btn-primary', id: 'unassign_general_agency', disabled: true %>
        </div>
      <% end %>
    </div>
  </div>
</div>
