var containing_row = $("#<%= @element_to_replace_id %>").closest('TR');
var $parent_row = containing_row;
//var $parent_row = $(".table:first > tbody > tr:not(tr.child-row)").eq(<%= @row %>);
if ( $('tr.child-row:visible').length > 0 ) {
  $('tr.child-row:visible').remove();
  $("li>a:contains('Collapse Form')").addClass('disabled');

}

if ( $parent_row.next().hasClass('child-row') ) {
//
} 
else {
  $parent_row.after('<tr class="child-row"><td colspan="100"><%= j render "index"%></td></tr>');
  $("li>a:contains('Collapse Form')").eq(containing_row.index()).removeClass('disabled');
  $('.dropdown.pull-right').removeClass('open');
}

$( "#datepicker" ).datepicker();

$('input[name=plan_year_radio]').click(function() {
  hidePlanYearActions();
  clearDatePickerValue();
  hideTerminationRadios();
  $('.py-btn-grp').addClass('disabled')
  if(($(this).attr("status") == "draft")) {
    $('input[name=plan_year_radio]:checked').closest('tr').next('tr').removeClass('hidden')
  } else {
    $('input[name=plan_year_radio]:checked').closest('td').siblings().find('.py-btn-grp').removeClass('disabled')
  }
});

// $('input[name=term_actions]').click(function() {
//   $('.py-btn-grp').removeClass('disabled')
// });

$('#plan-year-btn-group ul li').each(function() {
  $(this).click(function() {
    // Do Something
  })
});


function hidePlanYearActions() {
  $('.plan-year-actions').addClass('hidden');
}

function showPlanYearActions(id) {
  $('#'+id).removeClass('hidden');
}

function disableDatePicker() {
  $('input#datepicker').prop('disabled', true);
}

function enableDatePicker() {
  $('input#datepicker').prop('disabled', false);
}

function clearDatePickerValue() {
  $('input#datepicker').val('');
  enableDatePicker()
}

function disableSubmitButton() {
  $('.plan-year-submit').addClass('disabled')
}

function enableSubmitButton() {
  $('.plan-year-submit').removeClass('disabled')
}

function showTerminationRadios() {
  $('.term_action_radios').removeClass('hidden');
}

function hideTerminationRadios() {
  $('.term_action_radios').addClass('hidden');
}


function pyAction(action, id, term_date) {
  showPlanYearActions(id);
  if (action == "reinstate") {
    console.log(term_date)
    disableDatePicker();
    $('input#datepicker').val(term_date);
    hideTerminationRadios();
    enableSubmitButton()
  }
  
  if (action == 'terminate') {
    showTerminationRadios();
    clearDatePickerValue();
    disableSubmitButton();
  }
  
  if (action == 'cancel') {
    hideTerminationRadios();
    clearDatePickerValue();
    disableSubmitButton();
  }
}

function submitPlanActions() {
  alert("Im Submitted")
}

applyJQDatePickers();