<div class='container'>
  <div class="row">
    <h3 class="title-inline">Binder Transition Information</h3>
  </div>
</div>

<%= form_tag binder_paid_exchanges_hbx_profiles_path, method: :post, id: 'binder_paid_index' do %>
  <div class="module">
    <table id="binder-transition-dataTable" class="table table-striped table-hover table-sm display select">
      <thead class="thead-default">
        <tr>
         <th>
            <%= check_box_tag "checkall" %> &nbsp; &nbsp;Select All
         </th>
         <th>Name</th>
         <th>Status</th>
         <th>Employer Type</th>
         <th>Eligibility Criteria</th>
        </tr>
      </thead>
      <tbody>
        <% @organizations.each do |organization| %>
          <% employer = organization.employer_profile %>
          <% if employer.is_new_employer? || employer.is_renewing_employer? %>
            <tr>
              <td>
                <%= check_box_tag("employer_profile_ids[]", employer.id, nil, id: "employer_profile_id_#{employer.id.to_s}", disabled: make_binder_checkbox_disabled(employer), class: "binderCheckBox") %>
              </td>
              <td><%= employer.legal_name %></td>
              <td><%= employer.aasm_state.titleize %></td>
              <td><%= employer.renewing_plan_year.present? ? "Renewing" : "New" %></td>
              <td class="eligibility-rule">
                <%= eligibility_criteria(employer) %>
              </td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  </div>
  <%= submit_tag "Binder Paid", class: 'btn btn-primary', id: "binderSubmit" %>
<% end %>

<script type="text/javascript">

  $(document).ready(function(){
    var table = $('#binder-transition-dataTable').DataTable(
      {
        "processing": true,
        "serverSide": true,
        "ordering" : false,
        "ajax": {
          url: "<%= binder_index_datatable_exchanges_hbx_profiles_path(format: :json) %>",
          type: "GET"
        }
      }
    );

    binderTransition.init();
  });

</script>